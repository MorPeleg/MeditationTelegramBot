# Dynamic BCT-Based Motivational Message System

## ðŸŽ¯ Overview

The meditation bot now features **dynamic, personalized motivational messages** generated by an LLM (Large Language Model) using evidence-based **Behavior Change Techniques (BCT)** from the Michie et al. 2013 taxonomy.

## âœ¨ Key Features

### 1. **Personalized Message Generation**
- Messages are tailored to each user's profile (name, age, motivation, meditation duration)
- Takes into account the user's current day in their meditation journey
- Adapts to user's specific meditation goals and preferences

### 2. **Evidence-Based BCT Integration**
- Uses 93 behavior change techniques from the validated BCT Taxonomy v1
- Each message displays the specific BCT IDs used (e.g., "BCT 1.2, 8.1")
- Selects relevant BCTs for meditation and mindfulness contexts

### 3. **Context-Aware Messaging**
- **Daily messages**: Standard motivational content
- **Streak messages**: Celebrate consistency and momentum
- **Comeback messages**: Supportive for users returning after breaks
- **Struggle messages**: Encouraging for difficulty periods
- **Milestone messages**: Achievement celebration
- **Insight messages**: Based on user analytics and progress

### 4. **Intelligent Fallback System**
- Graceful degradation when LLM API is unavailable
- High-quality pre-written messages with BCT annotations
- Ensures system reliability and user experience

## ðŸ§  BCT Categories Used

The system focuses on meditation-relevant BCTs across these categories:

### Goals and Planning (1.x)
- `1.1` Goal setting (behavior)
- `1.2` Problem solving
- `1.4` Action planning
- `1.5` Review behavior goals
- `1.9` Commitment

### Feedback and Monitoring (2.x)
- `2.3` Self-monitoring of behavior
- `2.4` Self-monitoring of outcomes
- `2.7` Feedback on outcomes

### Social Support (3.x)
- `3.1` Social support (unspecified)
- `3.3` Social support (emotional)

### Natural Consequences (5.x)
- `5.1` Information about health consequences
- `5.2` Salience of consequences
- `5.6` Information about emotional consequences

### Repetition and Substitution (8.x)
- `8.1` Behavioral practice/rehearsal
- `8.3` Habit formation
- `8.7` Graded tasks

### Reward and Threat (10.x)
- `10.7` Self-incentive
- `10.9` Self-reward

### Regulation (11.x)
- `11.2` Reduce negative emotions

### Antecedents (12.x)
- `12.1` Restructuring physical environment
- `12.4` Distraction

### Identity (13.x)
- `13.1` Identification of self as role model
- `13.2` Framing/reframing
- `13.4` Valued self-identity
- `13.5` Identity associated with changed behavior

### Self-belief (15.x)
- `15.1` Verbal persuasion about capability
- `15.2` Mental rehearsal of successful performance
- `15.3` Focus on past success
- `15.4` Self-talk

## ðŸ”§ Implementation Details

### Message Generation Flow
1. **User Context Analysis**: Extract user profile, current day, meditation history
2. **BCT Selection**: Randomly select 1-3 relevant BCTs from meditation-focused subset
3. **LLM Prompt Construction**: Create personalized prompt with user data and BCT descriptions
4. **Message Generation**: Use GPT-3.5-turbo to generate contextual message
5. **BCT Annotation**: Append BCT IDs to message in parentheses
6. **Fallback Handling**: Use pre-written messages if LLM fails

### API Integration
```javascript
// Example usage
const message = await messageGenerationService.generateMotivationalMessage(user, currentDay);
// Returns: "Your daily practice is building lasting change in your mind and body. (BCT 8.1, 13.1)"
```

### Configuration
Set your OpenAI API key in `.env`:
```env
OPENAI_API_KEY=your_actual_openai_api_key_here
```

## ðŸ“Š Message Types

### 1. Daily Motivational Messages
- Standard daily encouragement
- Personalized to user's meditation goals
- Incorporates relevant BCTs naturally

### 2. Context-Specific Messages
- **Streak**: Acknowledges consistency achievements
- **Comeback**: Supportive for returning users
- **Struggle**: Encouragement during difficult periods
- **Milestone**: Celebration of significant progress

### 3. Analytics-Based Insights
- Generated from user's meditation statistics
- Highlights specific achievements and patterns
- Provides data-driven encouragement

## ðŸŽ¯ Example Messages

### Personalized Daily Message
```
"Sarah, your commitment to reducing anxiety through meditation is inspiring! Today's 10-minute session is another step toward the peaceful mind you're building. (BCT 1.2, 13.4)"
```

### Streak Achievement
```
"Amazing! Your 7-day meditation streak proves you're becoming someone who prioritizes mental wellbeing. This consistency is creating lasting neural pathways for peace. (BCT 2.3, 13.1)"
```

### Analytics Insight
```
"Your 85% completion rate shows remarkable dedication to your practice! Each completed session strengthens your ability to find calm in any situation. (BCT 15.3, 8.3)"
```

## ðŸ”’ Reliability Features

### Graceful Degradation
- System works even without OpenAI API key
- High-quality fallback messages ensure consistent experience
- Error logging for monitoring and debugging

### Performance Optimization
- Efficient BCT selection algorithms
- Caching strategies to reduce API calls
- Timeout handling for API requests

### User Experience
- Consistent message format with BCT annotations
- Contextually appropriate tone and content
- Seamless integration with existing bot features

## ðŸ“ˆ Benefits

### For Users
- **More Engaging**: Personalized content feels more relevant
- **Educationally Rich**: Learn about behavior change science
- **Motivation Boost**: Evidence-based encouragement techniques
- **Progress Awareness**: Messages reflect personal journey

### For Researchers/Developers
- **Evidence-Based**: Grounded in validated behavior change theory
- **Measurable**: BCT IDs allow for intervention tracking
- **Scalable**: Can generate unlimited unique messages
- **Adaptable**: Easy to modify BCT selection criteria

## ðŸš€ Future Enhancements

1. **Advanced Personalization**: Learn from user feedback to improve message relevance
2. **A/B Testing**: Compare effectiveness of different BCT combinations
3. **Multi-language Support**: Generate messages in user's preferred language
4. **Timing Optimization**: Send messages at optimal times for each user
5. **Integration Analytics**: Track which BCTs are most effective for different user types

## ðŸ§ª Testing

Run the test suite to see dynamic messages in action:
```bash
node test-dynamic-messages.js
```

This will demonstrate:
- Personalized messages for different user profiles
- Context-aware message generation
- Analytics-based insights
- Fallback message system

## ðŸ“š References

- Michie, S., et al. (2013). The behavior change technique taxonomy (v1) of 93 hierarchically clustered techniques. *Annals of Behavioral Medicine*, 46(1), 81-95.
- BCT Taxonomy v1: Complete list of 93 behavior change techniques
- OpenAI GPT-3.5-turbo API for natural language generation